
{% extends 'base.html.twig' %}

{% block title %}Recette{% endblock %}

{% block body %}
    <h1>Recette</h1>
{# recette:
{{dump(recette)}}
liste ingredients
{{dump(listeIngredient)}}
liste etapes
{{dump(listeEtapes)}}
nombre d'étapes
{{dump(nombreEtapes)}}
liste commentaire 
{{dump(listeCommentaires)}}
note moyenne
{{dump(moyenneNote)}}
have noted
{{dump(haveNoted)}} #}
    <div class="container">
        <div class="row">
            <div class="col-12">
                {% if recette.image %}
                    {{recette.image}}
                {% endif %}
                <h2>{{recette.name}}</h2>
            </div>
            {% if app.user %}
            {% if recette not in user.getRecettesFavId() %}
            <div>
                {{ form_start(formFavori) }}
                {# {% autoescape 'html' %}
                {{ form_label(formFavori, '<img src="/Images/heart.png" alt="coeur plein">') }}
                {{ form_widget(formFavori) }}

                {% endautoescape %}#}
                <div class="col-2">
                    <p>Ajouter en favori :</p>
                    <button type="submit" id="favori_ajoutFavori" name="favori[ajoutFavori]" class="form-control"><img style="width:40px" src="/Images/heartempty.png" alt="coeur vide">
                        {{ form_row(formFavori.ajoutFavori, {'attr': {'label': ' ', 'style': 'display:none'}}) }}
                    </button>
                </div>
                {{ form_end(formFavori) }}
                
            </div>
            {% else %}
            <div>
                {{ form_start(removeFavori) }}
              
               <div class="col-2">
                    <p>Retirer des favoris :</p>
                    <button type="submit" id="remove_favori_enleverFavori" name="remove_favori[enleverFavori]" class="form-control" label=" "><img style="width:40px" src="/Images/heart.png" alt="coeur plein">
                     {{ form_row(removeFavori.enleverFavori, {'attr': {'label': ' ', 'style': 'display:none'}}) }}
                </button>
                </div>
                {{ form_end(removeFavori) }}
            </div>
                {% endif %}
                {% endif %}
            <div class="col-12">
                <h2><dl>pour {{recette.NbPersonnes}} Convives</h2>
            </div>
            <div class="container row col-12">
                {% for ingredients in listeIngredient %}
                    <div class="col-6">
                    <p><dt>{{ingredients.IngredientsId.name}} : <dd>{{ingredients.Quantite}} {{ingredients.UnitemesureId.name}}</p> 
                    </div>
                {% endfor %}
            </div>
            <div class="col-6">
                <p><dt>
                    Temps de préparation : <dd>{{recette.TempsPreparation}} minutes.
                </p>
            </div>
            <div class="col-6">
                <p><dt>Difficulté: 
                    {% if recette.Difficulte == 1 %}
                    <img src="{{asset("Images/toqueDificulte.png")}}">
                    {% elseif recette.Difficulte == 2 %}
                    <img src="{{asset("Images/toqueDificulte.png")}}">
                    <img src="{{asset("Images/toqueDificulte.png")}}">
                    {% elseif recette.Difficulte == 3 %}
                    <img src="{{asset("Images/toqueDificulte.png")}}">
                    <img src="{{asset("Images/toqueDificulte.png")}}">
                    <img src="{{asset("Images/toqueDificulte.png")}}">
                    {% else %}
                    something went wrong ! 
                    {% endif %}
                </p>
            </div>
            <div class="col-6">
                <p><dt>
                    Temps de cuisson : <dd>{{recette.TempsCuisson}} minutes.
                </p>
            </div>
            <div class="col-6">
                <p><dt>
                    Note : 
                    {% if moyenneNote == 0 %} 
                    <dd>Cette recette n'as pas encore reçu de Note
                    {% else %}
                    <dd>{{moyenneNote}}
                    {% endif %}

                    {# a mettre dans un template show_noted ??? #}
                    {# {% if noteUser %}
                    Vous avez notez cette recette : {{noteUser}}
                    {% endif %} #}
                </p>
            </div>
            <div class="col-6 placeholder">
            </div>
            {% if haveNoted == false %}
            <div class="col-6">
            {{ form_start(formNote) }}
                 {{ form_widget(formNote) }}
                <button class="btn">{{ button_label|default('Save') }}</button>
            {{ form_end(formNote) }}
            </div>
            {% endif %}
            <div class="col-12">
            <button class="col-12 btn btn-success btn-lg px-4 gap-3"> passer en mode slideshow. </button>
            </div>
            <div class="col-12">
                {% for etapes in listeEtapes %}
                    {% if etapes.image %}
                        <div class ="col-6">
                            <img src="#" alt="image de l'étape"/>
                            image de l'étapes
                        </div>
                        <div class="col-6">
                            <h2>{{etapes.name}}</h2>
                        </div>
                    {% else %}
                        <div class="col-12">
                            <h2>{{etapes.name}}</h2>
                        </div>
                    {% endif %}
                    <div class="col-12 row">
                        <div class="col-1 text-success">
                            {{etapes.isNumber}} / {{nombreEtapes}}
                        </div>
                        <div class="col-10">
                            {{etapes.description}}
                        </div>
                    </div>
                {% endfor %}
            </div>
            <div class="col-12 container p-3 my-3 bg-success text-white">
                <h4>commentaires : </h4>
                {% if listeCommentaires %}
                    {% for commentaire in listeCommentaires %}
                        <div class="col-3">
                            <p>
                                {{commentaire.userId.login}} : <br/>
                                le : {{commentaire.createdAt|date('d-m-Y')}} à {{commentaire.createdAt|date('h:i:s')}}
                            </p>
                        </div>
                        <div class="col-9">
                            <p class="text-dark">
                                {{commentaire.content}}
                            </p>
                        </div>
                    {% endfor %}
                {% else %}
                    <p>
                        Il n'y a pas encore de commentaires. 
                    </p>
                {% endif %}
            </div>
            <div class="col-12">
            Laisser un commentaire : 
            {{ form_start(formCommentaire) }}
                 {{ form_widget(formCommentaire) }}
                <button class="btn">{{ button_label|default('Save') }}</button>
            {{ form_end(formCommentaire) }}
            </div>

    {# {{ include('recette/_delete_form.html.twig') }} #}
{% endblock %}
